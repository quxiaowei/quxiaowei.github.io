<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><base href=https://quxiaowei.github.io><title>A.Smith</title><link rel=canonical href=https://quxiaowei.github.io/post/python_no_nested_anymore/><link rel="shortcut icon" href=img/favicon.jpg type=image/x-icon><link rel=stylesheet href=https://quxiaowei.github.io/css/bootstrap.min.css><link rel=stylesheet href=https://quxiaowei.github.io/css/styles.css><link rel=stylesheet href=https://quxiaowei.github.io/css/post.css><link href=https://quxiaowei.github.io/index.xml rel=alternate type=application/rss+xml title="A CodeSmith"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lobster"><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js></script><script src=./script/site.js></script></head><body><div class="column container"><header class=header><a href=/ class=title>A.Smith</a>
<span class=menu-bar><a href=/album/>ğŸ§</a></span></header><section id=main class=col-md-10><header class=post-header><p class=post-title>Python çš„ nested() ä¸è§äº†</p><p class=post-meta>2016å¹´7æœˆ14æ—¥</p></header><article itemprop=articleBody id=content><p>æœ€è¿‘åœ¨å’Œåˆ«çš„ç³»ç»Ÿæµ‹è¯• Rest Web Service çš„æ¥å£ï¼Œç”¨ python å†™äº†å•å…ƒæµ‹è¯•è„šæœ¬ <a href=https://gist.github.com/quxiaowei/5440de7c9e2e9b835e5b6225b040a491>(Gist)</a>ã€‚å´å‘ç°<code>nested</code>ä¸è§äº†ï¼ŒæŸ¥äº†æ›¿ä»£æ–¹æ¡ˆè®°ä¸‹ã€‚</p><p><code>with</code> å†™æ³•ï¼š</p><pre><code>with open('D:\\input.txt') as file1:
    with open('D:\\output.txt' 'w+') as file2:
        for line in file1.readline():
            file2.write(line+'\n')
</code></pre><p><code>nested()</code> å†™æ³•ï¼ˆ<code>caveat</code>: å·²ç»ä¸å¯ç”¨äº†ï¼‰ï¼š</p><pre><code>from contextlib import nested

with (open('D:\\input.txt'), open('D:\\output.txt', 'w+')) \
    as (file1, file2):
    
    for line in file1.readline():
        file2.write(line+'\n')
</code></pre><p>æ–°å†™æ³•ï¼š</p><pre><code>from contextlib import ExitStack

with ExitStack() as stack:
    file1 = stack.enter_context(open('D:\\input.txt'))
    file2 = stack.enter_context(open('D:\\output.txt', 'w+'))
    for line in file1.readline():
        file2.write(line+'\n')
</code></pre><p>å…¶å®å¯¹äºä¸€ä¸¤ä¸ªèµ„æºæ¥è¯´ï¼Œç›´æ¥ç”¨ nested-with çš„è¯­æ³•å†™èµ·æ¥è¿˜è¡Œï¼Œç”¨ ExitStack çœ‹èµ·æ¥å°±æœ‰ç‚¹å•°å—¦äº†ã€‚å¯¹äºå¤šä¸ªèµ„æºæ¥è¯´ï¼Œç”¨<code>ExitStack</code> + <code>list comprehence</code>å†™èµ·æ¥å€’ä¹Ÿä¸éº»çƒ¦ã€‚</p><p>ã€ çµ‚ ã€</p></article></section><footer class=bottom-footer></footer><script>renderMathInElement(document.getElementById('main'));</script></div><a href=javascript: id=return-to-top><i class=icon-chevron-up></i></a><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet></body></html>